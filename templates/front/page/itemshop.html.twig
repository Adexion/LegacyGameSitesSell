{% extends 'front/base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    {{ encore_entry_link_tags('itemshopStyle') }}
    <script src="https://www.paypal.com/sdk/js?client-id={{ paypalClient }}&currency=PLN"></script>
{% endblock %}

{% block body %}
    <div class="container pt-2">
        <div class="row">
            {% include 'front/component/notLogged.html.twig' %}
            <div class="d-inline-flex w-100 flex-wrap flex-column">
                {% for itemList in itemLists %}
                    <div class="item-list bg-light p-2">
                        <div class="item-list-content">
                            <img src="{{ itemList.icon }}" alt="{{ itemList.name }}">
                            <hr/>
                            <div class="p-2">
                                <p class="font-weight-bold h5">{{ itemList.name }}</p>
                                {{ itemList.description | raw }}
                            </div>
                            <hr/>
                        </div>
                        <div>
                            <p class="price float-left"><i class="fas fa-coins"></i> {{ (itemList.price - (itemList.promotion * itemList.price)) | number_format(2) }} <strong>zł</strong></p>
                            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                            <button type="button" class="btn btn-primary float-right" data-toggle="modal" data-target="#exampleModal">
                                Zapłać
                            </button>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="paypal-button-container"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger">Zamknij</button>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{#<script>#}
{#    paypal.Buttons({#}
{#        createOrder: function (data, actions) {#}
{#            return actions.order.create({#}
{#                purchase_units: [{#}
{#                    amount: {#}
{#                        currency_code: 'PLN',#}
{#                        value: '{{ itemList.price - (itemList.promotion * itemList.price) }}'#}
{#                    }#}
{#                }]#}
{#            });#}
{#        },#}
{#        onApprove: function (data, actions) {#}
{#            return actions.order.capture().then(function (details) {#}

{#            });#}
{#        }#}
{#    }).render('#paypal-button-container{{ itemList.id }}');#}
{#</script>#}
